(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{42:function(e,t,a){},57:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(1),s=a(44),i=a.n(s),r=a(10),l=a(26),o=a(35);a(52),a(54),a(75);o.a.initializeApp({apiKey:"AIzaSyCUpv01zIUn0iva6jJ-6NkCVbaSFxwaoQo",authDomain:"slack-app-cc624.firebaseapp.com",databaseURL:"https://slack-app-cc624.firebaseio.com",projectId:"slack-app-cc624",storageBucket:"slack-app-cc624.appspot.com",messagingSenderId:"43530332645",appId:"1:43530332645:web:8b1697523b9015b73c270c",measurementId:"G-GYE5XRHWQT"});var d=o.a,u=a(4),j=Object(c.createContext)();var b=function(e){var t=e.children,a=Object(c.useState)("true"===localStorage.getItem("darkMode")||!1),s=Object(u.a)(a,2),i=s[0],r=s[1];return Object(c.useEffect)((function(){localStorage.setItem("darkMode",i)}),[i]),Object(n.jsx)(j.Provider,{value:{darkMode:i,setDarkMode:r},children:t})},m=Object(c.createContext)();var h=function(e){var t=e.children,a=Object(c.useState)(null),s=Object(u.a)(a,2),i=s[0],r=s[1],l=Object(c.useState)(!1),o=Object(u.a)(l,2),d=o[0],j=o[1],b=Object(c.useState)(""),h=Object(u.a)(b,2),f=h[0],O=h[1];return Object(n.jsx)(m.Provider,{value:{setCurrentChannel:r,currentChannel:i,privateChannel:d,setPrivateChannel:j,activeChannel:f,setActiveChannel:O},children:t})},f=(a(57),a(58),a(59),a.p+"static/media/sun.7d1e1b01.svg"),O=a.p+"static/media/moon.628d1de5.svg";var v=function(){var e=Object(c.useContext)(j),t=e.darkMode,a=e.setDarkMode;return Object(n.jsx)("div",{className:"OptionsPanel",children:Object(n.jsx)("div",{className:"OptionsPanel-theme",onClick:function(){a((function(e){return!e}))},children:t?Object(n.jsx)("img",{className:"light-mode-icon",src:f,alt:"Light"}):Object(n.jsx)("img",{className:"dark-mode-icon",src:O,alt:"Dark"})})})},p=Object(c.createContext)();var g=function(e){var t=e.children,a=Object(c.useState)(null),s=Object(u.a)(a,2),i=s[0],r=s[1],l=Object(c.useState)(!0),o=Object(u.a)(l,2),d=o[0],j=o[1];return Object(n.jsx)(p.Provider,{value:{currentUser:i,loading:d,setUser:function(e){r(e),j(!1)},clearUser:function(e){r(null),j(!1)}},children:t})},x=a.p+"static/media/settings-icon.e5ff19e1.svg",N=a.p+"static/media/settings-dark-mode.c7cec136.svg",C=a.p+"static/media/user-icon.2ab6e483.svg",S=a.p+"static/media/logout-icon.b382cc9b.svg";var y=function(){var e=Object(c.useContext)(p).currentUser,t=Object(c.useContext)(j).darkMode,a=Object(c.useRef)(null),s=Object(c.useState)(!1),i=Object(u.a)(s,2),r=i[0],l=i[1],o=Object(c.useState)(""),b=Object(u.a)(o,2),m=b[0],h=b[1],f=Object(c.useState)(""),O=Object(u.a)(f,2),v=O[0],g=O[1],y=Object(c.useState)(d.storage().ref()),k=Object(u.a)(y,2),w=k[0],M=(k[1],Object(c.useState)(d.auth().currentUser)),_=Object(u.a)(M,2),P=_[0],U=(_[1],Object(c.useState)(d.database().ref("users"))),E=Object(u.a)(U,2),L=E[0],T=(E[1],Object(c.useState)({contentType:"image/jpeg"})),A=Object(u.a)(T,2),D=A[0];return A[1],Object(c.useEffect)((function(){""!==m&&w.child("avatars/users/".concat(P.uid)).put(m,D).then((function(e){e.ref.getDownloadURL().then((function(e){g(e)}))}))}),[m]),Object(c.useEffect)((function(){""!==v&&(P.updateProfile({photoURL:v}).then((function(){console.log("photo updated"),l(!1)})).catch((function(e){console.log(e)})),L.child(e.uid).update({avatar:v}).then((function(){console.log("user avatar updated")})).catch((function(e){console.log(e)})))}),[v]),e?Object(n.jsxs)("div",{className:"UserPanel",children:[Object(n.jsx)("div",{className:"UserPanel-image",children:Object(n.jsx)("img",{src:e.photoURL,alt:e.displayName})}),Object(n.jsxs)("div",{className:"UserPanel-info",children:[Object(n.jsx)("div",{className:"UserPanel-info__name",children:e.displayName}),Object(n.jsx)("div",{onClick:function(){l((function(e){return!e}))},className:"UserPanel-info__settings",title:"Settings",children:Object(n.jsx)("img",{src:t?N:x,alt:"settings"})})]}),Object(n.jsxs)("ul",{className:"UserPanel-settings-dropdown ".concat(r&&"open"),children:[Object(n.jsxs)("li",{onClick:function(){a.current.click()},className:"settings-change-avatar",children:[Object(n.jsx)("img",{className:"settings-icon",src:C,alt:""}),Object(n.jsx)("input",{onChange:function(e){var t=e.target.files[0];t&&h(t)},type:"file",ref:a,accept:".jpg, .jpeg, .png",style:{display:"none"}}),"Change Avatar"]}),Object(n.jsxs)("li",{onClick:function(){d.auth().signOut().then((function(){console.log("signed out")}))},className:"settings-signout",children:[Object(n.jsx)("img",{className:"settings-icon",src:S,alt:""}),"Sign Out"]})]})]}):Object(n.jsx)("div",{})},k=a(27),w=a(18),M=a.p+"static/media/arrow-down.d54be5f6.svg",_=a.p+"static/media/hashtag.48a50352.svg";var P=function(){var e=Object(c.useContext)(p).currentUser,t=Object(c.useContext)(m),a=t.setCurrentChannel,s=t.setPrivateChannel,i=t.setActiveChannel,r=t.activeChannel,l=Object(c.useState)(d.database().ref("users")),o=Object(u.a)(l,2),j=o[0],b=(o[1],Object(c.useState)([])),h=Object(u.a)(b,2),f=h[0],O=h[1];return Object(c.useEffect)((function(){var t;return e&&(t=e.uid,j.child(t).child("starred").on("child_added",(function(e){var t=Object(w.a)({id:e.key},e.val());O((function(e){return[].concat(Object(k.a)(e),[t])}))})),j.child(t).child("starred").on("child_removed",(function(e){var t=Object(w.a)({id:e.key},e.val());f.filter((function(e){return e.id!==t.id})),O((function(e){return e.filter((function(e){return e.id!==t.id}))}))}))),function(){e&&j.child("".concat(e.uid,"/starred")).off()}}),[]),Object(n.jsxs)("div",{className:"Channels-component",children:[Object(n.jsx)("div",{className:"Channels",children:Object(n.jsxs)("div",{className:"Channels-name",children:[Object(n.jsx)("img",{src:M,alt:""}),"starred",Object(n.jsx)("span",{className:"Channel-counter",children:f.length})]})}),function(e){if(e.length>0){var t=e.map((function(e){return Object(n.jsxs)("li",{className:"channel-item ".concat(e.id===r&&"active"),onClick:function(){return function(e){i(e.id),a(e),s(!1)}(e)},title:e.name,children:[Object(n.jsx)("img",{src:_,alt:"#"}),e.name]},e.id)}));return Object(n.jsx)("ul",{className:"Channel-items",children:t})}}(f)]})},U=a(21),E=a.p+"static/media/hashtag-dark.e3908581.svg",L=a.p+"static/media/add-icon.2b701364.svg",T=a.p+"static/media/add-dark-mode.0a8c723f.svg";var A=function(){var e=Object(c.useContext)(m),t=e.currentChannel,a=e.setCurrentChannel,s=e.setPrivateChannel,i=e.setActiveChannel,r=e.activeChannel,l=Object(c.useContext)(p).currentUser,o=Object(c.useContext)(j).darkMode,b=Object(c.useState)([]),h=Object(u.a)(b,2),f=h[0],O=h[1],v=Object(c.useState)({channelName:"",channelDetails:""}),g=Object(u.a)(v,2),x=g[0],N=g[1],C=Object(c.useState)(!1),S=Object(u.a)(C,2),y=S[0],P=S[1],A=Object(c.useState)(d.database().ref("channels")),D=Object(u.a)(A,2),I=D[0],R=(D[1],Object(c.useState)(d.database().ref("messages"))),B=Object(u.a)(R,2),F=B[0],H=(B[1],Object(c.useState)(d.database().ref("typing"))),K=Object(u.a)(H,2),q=K[0],z=(K[1],Object(c.useState)(null)),V=Object(u.a)(z,2),W=V[0],J=V[1],Y=Object(c.useState)([]),G=Object(u.a)(Y,2),Q=G[0],$=G[1],X=Object(c.useState)(null),Z=Object(u.a)(X,2),ee=Z[0],te=Z[1];function ae(){P(!1)}function ne(e){N((function(t){return Object(w.a)(Object(w.a)({},t),{},Object(U.a)({},e.target.name,e.target.value))}))}function ce(){var e=Q.findIndex((function(e){return e.id===W.id}));if(-1!==e){var t=Object(k.a)(Q);t[e].total=Q[e].lastKnownTotal,t[e].count=0,$(t)}}function se(e){setTimeout((function(){var t=0;if(Q.forEach((function(a){a.id===e.id&&(t=a.count)})),t>0)return t}),1)}return Object(c.useEffect)((function(){return function(){var e=[];I.on("child_added",(function(t){te(t),e.push(t.val()),O(e)}))}(),function(){I.off(),f.forEach((function(e){F.child(e.id).off()}))}}),[]),Object(c.useEffect)((function(){setTimeout((function(){f.length>0&&(i(f[0].id),a(f[0]),J(f[0]))}),1e3)}),[f]),Object(c.useEffect)((function(){var e;W&&ee&&(e=ee.key,F.child(e).on("child_added",(function(t){W&&function(e,t,a,n){var c=0,s=a.findIndex((function(t){return t.id===e}));-1!==s?(e!==t&&(c=a[s].total,n.numChildren()-c>0&&(a[s].count=n.numChildren()-c)),a[s].lastKnownTotal=n.numChildren()):a.push({id:e,total:n.numChildren(),lastKnownTotal:n.numChildren(),count:0}),$(a)}(e,W.id,Q,t)})))}),[W]),Object(n.jsxs)("div",{className:"Channels-component",children:[Object(n.jsxs)("div",{className:"Channels",children:[Object(n.jsxs)("div",{className:"Channels-name",children:[Object(n.jsx)("img",{src:M,alt:""}),"channels",Object(n.jsx)("span",{className:"Channel-counter",children:f.length})]}),Object(n.jsx)("div",{onClick:function(){P(!0)},className:"Channels-add",title:"Add Channel",children:Object(n.jsx)("img",{src:o?T:L,alt:"+"})})]}),function(e){if(e.length>0){var c=e.map((function(e){return Object(n.jsxs)("li",{className:"channel-item ".concat(e.id===r&&"active"),onClick:function(){return function(e){q.child(t.id).child(l.uid).remove(),i(e.id),ce(),a(e),s(!1),J(e)}(e)},title:e.name,children:[se(e)&&Object(n.jsx)("div",{className:"notification",children:se(e)}),Object(n.jsx)("img",{src:o?E:_,alt:"#"}),e.name]},e.id)}));return Object(n.jsx)("ul",{className:"Channel-items",children:c})}}(f),Object(n.jsx)("div",{className:"add-channel-window ".concat(y&&"open"),children:Object(n.jsxs)("form",{className:"add-channel-form",children:[Object(n.jsx)("input",{type:"text",name:"channelName",placeholder:"Name",onChange:ne,value:x.channelName}),Object(n.jsx)("input",{type:"text",name:"channelDetails",placeholder:"Description",onChange:ne,value:x.channelDetails}),Object(n.jsxs)("div",{className:"add-channel-buttons",children:[Object(n.jsx)("button",{onClick:function(e){e.preventDefault(),function(e){var t=e.channelName,a=e.channelDetails;return""!==t&&""!==a}(x)&&function(){var e=I.push().key,t={id:e,name:x.channelName,details:x.channelDetails,createdBy:{name:l.displayName,avatar:l.photoURL}};I.child(e).update(t).then((function(){ae(),N({channelName:"",channelDetails:""}),console.log("channel added")})).catch((function(e){console.log(e)}))}()},className:"btn add-btn",children:"Add"}),Object(n.jsx)("button",{type:"button",onClick:ae,className:"btn cancel-btn",children:"Cancel"})]})]})})]})};var D=function(){var e=Object(c.useContext)(m),t=e.setCurrentChannel,a=e.setPrivateChannel,s=e.setActiveChannel,i=e.activeChannel,r=Object(c.useContext)(p).currentUser,l=Object(c.useState)([]),o=Object(u.a)(l,2),j=o[0],b=o[1],h=Object(c.useState)(d.database().ref("users")),f=Object(u.a)(h,2),O=f[0],v=(f[1],Object(c.useState)(d.database().ref(".info/connected"))),g=Object(u.a)(v,2),x=g[0],N=(g[1],Object(c.useState)(d.database().ref("presence"))),C=Object(u.a)(N,2),S=C[0];function y(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=j.reduce((function(a,n){return n.uid===e&&(n.status="".concat(t?"online":"offline")),a.concat(n)}),[]);b(a)}function k(e){var n={id:function(e){var t=r.uid;return e<t?"".concat(e,"/").concat(t):"".concat(t,"/").concat(e)}(e.uid),name:e.name};t(n),a(!0),s(e.uid)}return C[1],Object(c.useEffect)((function(){return r&&function(e){var t=[];O.on("child_added",(function(a){if(e!==a.key){var n=a.val();n.uid=a.key,n.status="offline",t.push(n),b(t)}})),x.on("value",(function(t){if(!0===t.val()){var a=S.child(e);a.set(!0),a.onDisconnect().remove((function(e){null!==e&&console.log(e)}))}})),S.on("child_added",(function(t){e!==t.key&&y(t.key)})),S.on("child_removed",(function(t){e!==t.key&&y(t.key,!1)}))}(r.uid),function(){O.off(),S.off(),x.off()}}),[]),Object(n.jsxs)("div",{className:"Channels-component",children:[Object(n.jsx)("div",{className:"Channels",children:Object(n.jsxs)("div",{className:"Channels-name",children:[Object(n.jsx)("img",{src:M,alt:""}),"direct messages",Object(n.jsx)("span",{className:"Channel-counter",children:j&&j.length})]})}),function(e){if(e&&e.length>0){var t=e.map((function(e){return Object(n.jsxs)("li",{className:"channel-item ".concat(e.uid===i&&"active"),onClick:function(){return k(e)},title:e.name,children:[Object(n.jsx)("img",{className:"avatar-img",src:e.avatarPhoto,alt:"@"}),e.name,Object(n.jsx)("div",{className:"status-circle ".concat(e.status)})]},e.uid)}));return Object(n.jsx)("ul",{className:"Channel-items",children:t})}}(j)]})},I=(a(60),a.p+"static/media/chat-icon.ecd61459.svg");var R=function(){return Object(n.jsxs)("div",{className:"SidePanel",children:[Object(n.jsxs)("h1",{className:"SidePanel-title",children:[Object(n.jsx)("span",{className:"title__icon",children:Object(n.jsx)("img",{src:I,alt:""})})," ","chattier"]}),Object(n.jsx)(y,{}),Object(n.jsx)(P,{}),Object(n.jsx)(A,{}),Object(n.jsx)(D,{})]})},B=a(30),F=a.n(B),H=a(77),K=a(36),q=a.n(K),z=a.p+"static/media/galery.a5b10b5b.svg";var V=function(e){var t=e.displayMedia,a=e.uploadFile,s=Object(c.useRef)(null),i=Object(c.useState)(null),r=Object(u.a)(i,2),l=r[0],o=r[1],d=Object(c.useState)(["image/jpeg","image/jpg","image/png"]),j=Object(u.a)(d,2),b=j[0];return j[1],Object(c.useEffect)((function(){!function(){if(null!==l&&(t=l.name,b.includes(q.a.lookup(t)))){var e={contentType:q.a.lookup(l.name)};a(l,e),o(null)}var t}()}),[l]),Object(n.jsxs)("div",{onClick:function(){s.current.click()},className:"MediaModal ".concat(t&&"open"),children:[Object(n.jsx)("img",{src:z,alt:"Upload Media",title:"Add a photo"}),Object(n.jsx)("input",{onChange:function(e){var t=e.target.files[0];t&&o(t)},ref:s,type:"file",accept:".jpg, .jpeg, .png",style:{display:"none"}})]})},W=a(39),J=(a(67),a.p+"static/media/clip.499e8353.svg"),Y=a.p+"static/media/clip-dark-mode.8ed188b3.svg",G=a.p+"static/media/send-message.7b480b15.svg",Q=a.p+"static/media/emoji.45631553.svg";var $=function(e){e.messagesRef,e.setMessages;var t=e.setBlockScrollToBottom,a=e.getMessagesRef,s=Object(c.useContext)(p).currentUser,i=Object(c.useContext)(m),r=i.currentChannel,l=i.privateChannel,o=Object(c.useContext)(j).darkMode,b=Object(c.useState)(""),h=Object(u.a)(b,2),f=h[0],O=h[1],v=Object(c.useState)(!1),g=Object(u.a)(v,2),x=g[0],N=g[1],C=Object(c.useState)(""),S=Object(u.a)(C,2),y=S[0],k=S[1],w=Object(c.useState)(null),M=Object(u.a)(w,2),_=M[0],P=M[1],U=Object(c.useState)(d.storage().ref()),E=Object(u.a)(U,2),L=E[0],T=(E[1],Object(c.useState)(d.database().ref("typing"))),A=Object(u.a)(T,2),D=A[0],I=(A[1],Object(c.useState)(0)),R=Object(u.a)(I,2),B=(R[0],R[1]),F=Object(c.useState)(!1),K=Object(u.a)(F,2),q=K[0],z=K[1],$=Object(c.useRef)(null);function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={timestamp:d.database.ServerValue.TIMESTAMP,user:{id:s.uid,name:s.displayName,avatar:s.photoURL}};return null!==e?t.image=e:t.content=f,t}return Object(c.useEffect)((function(){return null!==_&&_.on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);B(t)}),(function(e){console.log(e),k("error"),P(null)}),(function(){_.snapshot.ref.getDownloadURL().then((function(e){var t,n,c;t=e,n=a(),c=r.id,n.child(c).push().set(X(t)).then((function(){k("done")})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e),k("error"),P(null)}))})),function(){null!==_&&(_.cancel(),P(null))}}),[_]),Object(c.useEffect)((function(){"done"===y&&addMessageListener(r.id)}),[y]),Object(c.useEffect)((function(){O("")}),[r]),Object(n.jsxs)("form",{className:"MessagesForm",children:[Object(n.jsxs)("button",{disabled:"uploading"===y,className:"MessagesForm-upload-media",onClick:function(){N(!x)},type:"button",title:"Upload Media",children:[Object(n.jsx)("img",{src:o?Y:J,alt:"Upload Media"}),Object(n.jsx)(V,{displayMedia:x,uploadFile:function(e,t){var a="".concat(l?"chat/private/".concat(r.id):"chat/public/".concat(r.id),"/").concat(Object(H.a)(),".jpg");k("uploading"),P(L.child(a).put(e,t))}})]}),Object(n.jsxs)("div",{className:"MessagesForm-input-container",children:[Object(n.jsx)("input",{className:"MessagesForm-input",ref:$,type:"text",placeholder:"Enter your message here",onChange:function(e){O(e.target.value)},onKeyDown:function(e){setTimeout((function(){e.target.value?D.child(r.id).child(s.uid).set(s.displayName):D.child(r.id).child(s.uid).remove()}),1)},value:f}),Object(n.jsx)("button",{className:"MessagesForm-emoji-picker",onClick:function(){z((function(e){return!e}))},title:"Pick an emoji",type:"button",children:Object(n.jsx)("img",{src:Q})}),q&&Object(n.jsx)("div",{className:"emoji-picker",children:Object(n.jsx)(W.a,{title:"Pick your emoji",onSelect:function(e){var t=function(e){return e.replace(/:[A-Za-z0-9_+-]+:/g,(function(e){e=e.replace(/:/g,"");var t=W.b.emojis[e];if("undefined"!==typeof t){var a=t.native;if("undefined"!==typeof a)return a}return e=":"+e+":"}))}("".concat(f," ").concat(e.colons));O(t),z(!1),$.current.focus()},theme:o?"dark":"light"})})]}),Object(n.jsxs)("button",{className:"MessagesForm-send ".concat(""===f&&"disabled"),onClick:function(e){e.preventDefault(),t(!1),""!==f&&a().child(r.id).push().set(X()).then((function(){O(""),D.child(r.id).child(s.uid).remove()})).catch((function(e){console.log(e)}))},title:"Send Message",children:["Send ",Object(n.jsx)("img",{src:G,alt:""})]})]})};var X=function(e){var t=e.message,a=Object(c.useContext)(p).currentUser;function s(e){return e.hasOwnProperty("image")&&!e.hasOwnProperty("content")}return a?Object(n.jsxs)("li",{className:"Message ".concat(t.user.id===a.uid&&"self-message"," ").concat(s(t)&&"image-wrapper"),"data-timestamp":t.timestamp,children:[Object(n.jsx)("div",{className:"Message__avatar",children:Object(n.jsx)("img",{src:t.user.avatar,alt:t.user.name})}),s(t)?Object(n.jsx)("img",{className:"Message__image",src:t.image,alt:""}):Object(n.jsx)("div",{className:"Message__content",children:t.content}),Object(n.jsx)("div",{className:"Message__time",children:F()(t.timestamp).format("HH:mm")})]}):""};var Z=function(){return Object(n.jsxs)("div",{className:"Typing",children:[Object(n.jsx)("div",{className:"Typing__dot"}),Object(n.jsx)("div",{className:"Typing__dot"}),Object(n.jsx)("div",{className:"Typing__dot"})]})};var ee=function(e){var t=e.className;return Object(n.jsxs)("div",{className:"Skeleton ".concat(t),children:[Object(n.jsx)("div",{className:"Skeleton__avatar"}),Object(n.jsxs)("div",{className:"Skeleton-details",children:[Object(n.jsx)("div",{className:"Skeleton-details__text"}),Object(n.jsx)("div",{className:"Skeleton-details__text shorter-text"})]})]})},te=(a(68),a.p+"static/media/search.52e43bda.svg"),ae=a.p+"static/media/search-dark-mode.fde230f1.svg",ne=a.p+"static/media/exit.8869ec30.svg",ce=a.p+"static/media/exit-dark-mode.de360789.svg",se=a.p+"static/media/star.9cb3dd8e.svg",ie=a.p+"static/media/star-clicked.2462f0e7.svg";var re=function(){var e=Object(c.useContext)(p).currentUser,t=Object(c.useContext)(m),a=t.currentChannel,s=t.privateChannel,i=Object(c.useContext)(j).darkMode,r=Object(c.useState)(d.database().ref("messages")),l=Object(u.a)(r,2),o=l[0],b=(l[1],Object(c.useState)(d.database().ref("privateMessages"))),h=Object(u.a)(b,2),f=h[0],O=(h[1],Object(c.useState)(d.database().ref("users"))),v=Object(u.a)(O,2),g=v[0],x=(v[1],Object(c.useState)(d.database().ref("typing"))),N=Object(u.a)(x,2),C=N[0],S=(N[1],Object(c.useState)(d.database().ref(".info/connected"))),y=Object(u.a)(S,2),w=y[0],M=(y[1],Object(c.useState)([])),_=Object(u.a)(M,2),P=_[0],E=_[1],L=Object(c.useState)(!0),T=Object(u.a)(L,2),A=T[0],D=T[1],I=Object(c.useRef)(null),R=Object(c.useRef)(null),B=Object(c.useState)(0),H=Object(u.a)(B,2),K=H[0],q=H[1],z=Object(c.useState)(!1),V=Object(u.a)(z,2),W=V[0],J=V[1],Y=Object(c.useState)(""),G=Object(u.a)(Y,2),Q=G[0],re=G[1],le=Object(c.useState)([]),oe=Object(u.a)(le,2),de=oe[0],ue=oe[1],je=Object(c.useState)(!1),be=Object(u.a)(je,2),me=be[0],he=be[1],fe=Object(c.useState)(!1),Oe=Object(u.a)(fe,2),ve=Oe[0],pe=Oe[1],ge=Object(c.useState)([]),xe=Object(u.a)(ge,2),Ne=xe[0],Ce=xe[1],Se=Object(c.useState)([]),ye=Object(u.a)(Se,2),ke=ye[0],we=ye[1];function Me(){ke.forEach((function(e){e.ref.child(e.id).off(e.event)}))}function _e(e,t,a){if(-1===ke.findIndex((function(n){return n.id===e&&n.ref===t&&n.event===a}))){var n={id:e,ref:t,event:a};we((function(e){return e.concat(n)}))}}function Pe(){return s?f:o}function Ue(){J(!1),re("")}return Object(c.useEffect)((function(){me||I.current.scrollIntoView({behavior:"smooth"})})),Object(c.useEffect)((function(){var t;return a&&e&&(Me(),function(e){E([]);var t=Pe();t.child(e).on("child_added",(function(e){E((function(t){return t.concat(e.val())}))})),_e(e,t,"child_added")}(t=a.id),function(t){var a=[];C.child(t).on("child_added",(function(t){t.key!==e.uid&&(a=a.concat({id:t.key,name:t.val()}),Ce(a))})),_e(t,C,"child_added"),C.child(t).on("child_removed",(function(e){-1!==a.findIndex((function(t){return t.id===e.key}))&&(a=a.filter((function(t){return t.id!==e.key})),Ce(a))})),_e(t,C,"child_removed"),w.on("value",(function(a){!0===a.val()&&C.child(t).child(e.uid).onDisconnect().remove((function(e){null!==e&&console.log(e)}))}))}(t),function(e,t){g.child(t).child("starred").once("value").then((function(t){if(null!==t.val()){var a=Object.keys(t.val()).includes(e);pe(a)}}))}(a.id,e.uid)),function(){Me(),w.off()}}),[a]),Object(c.useEffect)((function(){P.length>0&&(!function(e){var t=e.reduce((function(e,t){return e.includes(t.user.name)||e.push(t.user.name),e}),[]);q(t.length)}(P),D(!1))}),[P]),Object(c.useEffect)((function(){""!==Q?function(e){var t=new RegExp(e,"i"),a=P.reduce((function(e,a){return a.content&&t.test(a.content)&&e.push(a),e}),[]);ue(a)}(Q):ue([])}),[Q]),Object(c.useEffect)((function(){e&&a&&(ve?g.child("".concat(e.uid,"/starred")).update(Object(U.a)({},a.id,{name:a.name,details:a.details,createdBy:{name:a.createdBy.name,avatar:a.createdBy.avatar}})):g.child("".concat(e.uid,"/starred")).child(a.id).remove((function(e){null!==e&&console.log(e)})))}),[ve]),Object(n.jsxs)("div",{className:"Messages",children:[Object(n.jsxs)("div",{className:"Messages-window",children:[Object(n.jsxs)("div",{className:"Messages-header",children:[Object(n.jsxs)("div",{className:"Messages-header-info",children:[Object(n.jsxs)("div",{className:"Messages-header-info__channel-name",children:[a&&"".concat(s?"@":"#"," ").concat(a.name),!s&&Object(n.jsx)("img",{className:"channel-name__icon",onClick:function(){pe((function(e){return!e}))},src:ve?ie:se,alt:"\u2606"})]}),!s&&Object(n.jsx)("div",{className:"Messages-header-info__users",children:"".concat(K," user").concat(1!==K?"s":"")})]}),Object(n.jsx)("div",{className:"Messages-header-search",children:Object(n.jsx)("button",{onClick:function(){J(!0)},title:"Search Messages",type:"button",children:Object(n.jsx)("img",{src:i?ae:te})})})]}),Object(n.jsxs)("div",{className:"Messages-content-wrapper",children:[Object(n.jsxs)("ul",{ref:R,className:"Messages-content",children:[A?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(ee,{}),Object(n.jsx)(ee,{className:"Skeleton-self-message"}),Object(n.jsx)(ee,{}),Object(n.jsx)(ee,{})]}):function(e){if(e.length>0)return e.map((function(e){return Object(n.jsx)(X,{message:e},e.timestamp)}))}(P),Object(n.jsx)("div",{ref:I}),function(e){if(e.length>0)return console.log("a user is typing"),e.map((function(e){return Object(n.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:".5rem"},children:[Object(n.jsxs)("span",{className:"user-typing",children:[e.name," is typing"]}),Object(n.jsx)(Z,{})]},e.id)}))}(Ne)]}),Object(n.jsx)($,{messagesRef:o,setMessages:E,setBlockScrollToBottom:he,getMessagesRef:Pe})]})]}),Object(n.jsxs)("div",{className:"Messages-search-tab ".concat(W&&"open-tab"),children:[Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault()},className:"Messages-search-tab-header",children:[Object(n.jsx)("input",{onChange:function(e){re(e.target.value)},value:Q,type:"text",placeholder:"Search Messages"}),Object(n.jsx)("button",{onClick:Ue,type:"button",children:Object(n.jsx)("img",{src:i?ce:ne,alt:"x"})})]}),Object(n.jsx)("ul",{className:"Messages-search-tab-content",children:function(e){return e.map((function(e){return Object(n.jsxs)("li",{onClick:function(){return function(e){var t=Object(k.a)(R.current.children).findIndex((function(t){return t.getAttribute("data-timestamp")==e})),a=R.current.children.item(t);he(!0),a.scrollIntoView({block:"center"}),a.classList.contains("self-message")?(a.classList.add("self-message-searched"),setTimeout((function(){a.classList.remove("self-message-searched")}),2e3)):(a.classList.add("message-searched"),setTimeout((function(){a.classList.remove("message-searched")}),2e3)),Ue()}(e.timestamp)},className:"search-tab-content-item",children:[Object(n.jsx)("p",{className:"search-tab-content-item__mesage",children:e.content}),Object(n.jsx)("div",{className:"search-tab-content-item__date",children:F()(e.timestamp).format("DD/MM/YY HH:mm")})]},e.timestamp)}))}(de)})]})]})};a(69);var le=function(){var e=Object(c.useContext)(m),t=e.currentChannel,a=e.privateChannel;return Object(n.jsx)("div",{className:"MetaPanel-component",children:Object(n.jsxs)("div",{className:"MetaPanel",children:[!a&&Object(n.jsxs)("div",{className:"MetaPanel-field",children:[Object(n.jsx)("h5",{children:"channel details"}),Object(n.jsx)("p",{children:t&&t.details})]}),Object(n.jsx)("div",{className:"MetaPanel-field",children:Object(n.jsx)("h5",{children:"photos & media"})}),Object(n.jsx)("div",{className:"MetaPanel-field",children:Object(n.jsx)("h5",{children:"attachments"})})]})})};var oe=function(){var e=Object(c.useContext)(j).darkMode;return Object(n.jsx)("div",{className:"App ".concat(e&&"App--dark"),children:Object(n.jsxs)(h,{children:[Object(n.jsx)(R,{}),Object(n.jsx)(re,{}),Object(n.jsxs)("div",{className:"side-container",children:[Object(n.jsx)(v,{}),Object(n.jsx)(le,{})]})]})})};var de=function(){return Object(n.jsx)(b,{children:Object(n.jsx)(oe,{})})};a(42);var ue=function(){var e=Object(c.useState)({email:"",password:""}),t=Object(u.a)(e,2),a=t[0],s=t[1],i=Object(c.useState)(""),r=Object(u.a)(i,2),o=r[0],j=r[1],b=Object(c.useState)(!1),m=Object(u.a)(b,2),h=m[0],f=m[1];function O(e){document.querySelectorAll(".field").forEach((function(t){e.includes(t.name)&&t.classList.add("login-field-error")}))}function v(){return function(e){var t=e.email,a=e.password;return 0===t.length||0===a.length}(a)?(j("There are empty fields"),function(e){document.querySelectorAll(".field").forEach((function(t){""===e[t.name]&&t.classList.add("login-field-error")}))}(a),!1):function(e){var t=e.email;return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(t)}(a)?!(a.password.length<6)||(j("The password must have at least 6 characters"),O(["password","passwordConfirmation"]),!1):(j("Invalid email address"),O(["email"]),!1)}function p(e){e.target.classList.remove("field-error"),s(Object(w.a)(Object(w.a)({},a),{},Object(U.a)({},e.target.name,e.target.value)))}return Object(n.jsx)("div",{className:"Login auth-container",children:Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),v()&&(f(!0),d.auth().signInWithEmailAndPassword(a.email,a.password).then((function(e){console.log(e),j(""),f(!1)})).catch((function(e){console.log(e),j(e.message),f(!1)})))},className:"form login-form",children:[Object(n.jsxs)("div",{className:"form-header",children:[Object(n.jsxs)("h1",{className:"SidePanel-title",children:[Object(n.jsx)("span",{className:"title__icon",children:Object(n.jsx)("img",{src:I,alt:""})})," ","chattier"]}),Object(n.jsx)("p",{children:"Log In"})]}),Object(n.jsxs)("div",{className:"form-fields",children:[Object(n.jsx)("input",{className:"field login-field",name:"email",type:"text",placeholder:"Email Address",onChange:p,value:a.email}),Object(n.jsx)("input",{className:"field login-field",name:"password",type:"password",placeholder:"Password",onChange:p,value:a.password}),Object(n.jsx)("div",{className:"error-message login-error-message",children:Object(n.jsx)("p",{children:o})}),Object(n.jsx)("button",{className:"btn register-btn",disabled:h,children:h?Object(n.jsx)("div",{className:"btn-loader",children:"Loading..."}):"Submit"})]}),Object(n.jsx)("div",{className:"redirect login-redirect",children:Object(n.jsxs)("p",{children:["Don't have an account? ",Object(n.jsx)(l.b,{to:"/register",children:"Register"})]})})]})})},je=a(46),be=a.n(je);var me=function(){var e=Object(c.useState)({username:"",email:"",password:"",passwordConfirmation:""}),t=Object(u.a)(e,2),a=t[0],s=t[1],i=Object(c.useState)(""),r=Object(u.a)(i,2),o=r[0],j=r[1],b=Object(c.useState)(!1),m=Object(u.a)(b,2),h=m[0],f=m[1],O=Object(c.useState)(d.database().ref("users")),v=Object(u.a)(O,2),p=v[0];function g(e){document.querySelectorAll(".field").forEach((function(t){e.includes(t.name)&&t.classList.add("field-error")}))}function x(){return function(e){var t=e.username,a=e.email,n=e.password,c=e.passwordConfirmation;return 0===t.length||0===a.length||0===n.length||0===c}(a)?(j("There are empty fields"),function(e){document.querySelectorAll(".field").forEach((function(t){""===e[t.name]&&t.classList.add("field-error")}))}(a),!1):function(e){var t=e.email;return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(t)}(a)?a.password!==a.passwordConfirmation?(j("The passwords are different"),g(["password","passwordConfirmation"]),!1):!(a.password.length<6)||(j("The password must have at least 6 characters"),g(["password","passwordConfirmation"]),!1):(j("Invalid email address"),g(["email"]),!1)}function N(e){e.target.classList.remove("field-error"),s(Object(w.a)(Object(w.a)({},a),{},Object(U.a)({},e.target.name,e.target.value)))}return v[1],Object(n.jsx)("div",{className:"Register auth-container",children:Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),x()&&(f(!0),d.auth().createUserWithEmailAndPassword(a.email,a.password).then((function(e){console.log(e),j(""),e.user.updateProfile({displayName:a.username,photoURL:"https://avatar.oxro.io/avatar.svg?name=".concat(a.username,"&background=").concat(be()().slice(1),"&length=1")}).then((function(){(function(e){return p.child(e.user.uid).set({name:e.user.displayName,avatarPhoto:e.user.photoURL})})(e).then((function(){console.log("user saved"),f(!1)})).catch((function(e){console.log(e),f(!1)}))})).catch((function(e){console.log(e),f(!1)}))})).catch((function(e){console.log(e),j(e.message),f(!1)})))},className:"form register-form",children:[Object(n.jsxs)("div",{className:"form-header",children:[Object(n.jsxs)("h1",{className:"SidePanel-title",children:[Object(n.jsx)("span",{className:"title__icon",children:Object(n.jsx)("img",{src:I,alt:""})})," ","chattier"]}),Object(n.jsx)("p",{children:"Register"})]}),Object(n.jsxs)("div",{className:"form-fields",children:[Object(n.jsx)("input",{className:"field",name:"username",type:"text",placeholder:"Username",onChange:N,value:a.username}),Object(n.jsx)("input",{className:"field",name:"email",type:"text",placeholder:"Email Address",onChange:N,value:a.email}),Object(n.jsx)("input",{className:"field",name:"password",type:"password",placeholder:"Password",onChange:N,value:a.password}),Object(n.jsx)("input",{className:"field",name:"passwordConfirmation",type:"password",placeholder:"Password Confirmation",onChange:N,value:a.passwordConfirmation}),Object(n.jsx)("div",{className:"error-message",children:Object(n.jsx)("p",{children:o})}),Object(n.jsx)("button",{className:"btn register-btn",disabled:h,children:h?Object(n.jsx)("div",{className:"btn-loader",children:"Loading..."}):"Submit"})]}),Object(n.jsx)("div",{className:"redirect",children:Object(n.jsxs)("p",{children:["Already have an account? ",Object(n.jsx)(l.b,{to:"/login",children:"Log In"})]})})]})})};a(72);var he=function(){return Object(n.jsxs)("div",{className:"loader-container",children:[Object(n.jsxs)("h1",{className:"loader-title",children:[Object(n.jsx)("img",{src:I,alt:""})," chattier"]}),Object(n.jsx)("div",{className:"loader",children:"Loading..."})]})};a(73);var fe=Object(r.f)((function(e){var t=e.history,a=Object(c.useContext)(p),s=a.setUser,i=a.clearUser,l=a.loading;return Object(c.useEffect)((function(){d.auth().onAuthStateChanged((function(e){e?(s(e),t.push("/")):(i(e),t.push("/login"))}))}),[]),l?Object(n.jsx)(he,{}):Object(n.jsxs)(r.c,{children:["// We can't put the theme provider here because it causes the login and register routes not to mount. // The switch component only nests routes",Object(n.jsx)(r.a,{exact:!0,path:"/",component:de}),Object(n.jsx)(r.a,{path:"/login",component:ue}),Object(n.jsx)(r.a,{path:"/register",component:me})]})}));i.a.render(Object(n.jsx)(g,{children:Object(n.jsx)(l.a,{children:Object(n.jsx)(fe,{})})}),document.getElementById("root"))}},[[74,1,2]]]);
//# sourceMappingURL=main.88d29978.chunk.js.map